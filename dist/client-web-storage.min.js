(()=>{var Sr=Object.create;var Ke=Object.defineProperty;var _r=Object.getOwnPropertyDescriptor;var wr=Object.getOwnPropertyNames;var Ir=Object.getPrototypeOf,Er=Object.prototype.hasOwnProperty;var i=(m,s)=>Ke(m,"name",{value:s,configurable:!0}),Ie=(m=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(m,{get:(s,f)=>(typeof require!="undefined"?require:s)[f]}):m)(function(m){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+m+'" is not supported')});var Ar=(m,s)=>()=>(s||m((s={exports:{}}).exports,s),s.exports);var Tr=(m,s,f,h)=>{if(s&&typeof s=="object"||typeof s=="function")for(let y of wr(s))!Er.call(m,y)&&y!==f&&Ke(m,y,{get:()=>s[y],enumerable:!(h=_r(s,y))||h.enumerable});return m};var Dr=(m,s,f)=>(f=m!=null?Sr(Ir(m)):{},Tr(s||!m||!m.__esModule?Ke(f,"default",{value:m,enumerable:!0}):f,m));var We=(m,s,f)=>{if(!s.has(m))throw TypeError("Cannot "+f)};var S=(m,s,f)=>(We(m,s,"read from private field"),f?f.call(m):s.get(m)),z=(m,s,f)=>{if(s.has(m))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(m):s.set(m,f)},K=(m,s,f,h)=>(We(m,s,"write to private field"),h?h.call(m,f):s.set(m,f),f);var ge=(m,s,f)=>(We(m,s,"access private method"),f);var gt=Ar((pt,je)=>{(function(m){if(typeof pt=="object"&&typeof je<"u")je.exports=m();else if(typeof define=="function"&&define.amd)define([],m);else{var s;typeof window<"u"?s=window:typeof global<"u"?s=global:typeof self<"u"?s=self:s=this,s.localforage=m()}})(function(){var m,s,f;return i(function h(y,R,C){function V(M,Q){if(!R[M]){if(!y[M]){var g=typeof Ie=="function"&&Ie;if(!Q&&g)return g(M,!0);if(E)return E(M,!0);var _=new Error("Cannot find module '"+M+"'");throw _.code="MODULE_NOT_FOUND",_}var O=R[M]={exports:{}};y[M][0].call(O.exports,function(F){var H=y[M][1][F];return V(H||F)},O,O.exports,h,y,R,C)}return R[M].exports}i(V,"s");for(var E=typeof Ie=="function"&&Ie,Y=0;Y<C.length;Y++)V(C[Y]);return V},"e")({1:[function(h,y,R){(function(C){"use strict";var V=C.MutationObserver||C.WebKitMutationObserver,E;if(V){var Y=0,M=new V(F),Q=C.document.createTextNode("");M.observe(Q,{characterData:!0}),E=i(function(){Q.data=Y=++Y%2},"scheduleDrain")}else if(!C.setImmediate&&typeof C.MessageChannel<"u"){var g=new C.MessageChannel;g.port1.onmessage=F,E=i(function(){g.port2.postMessage(0)},"scheduleDrain")}else"document"in C&&"onreadystatechange"in C.document.createElement("script")?E=i(function(){var P=C.document.createElement("script");P.onreadystatechange=function(){F(),P.onreadystatechange=null,P.parentNode.removeChild(P),P=null},C.document.documentElement.appendChild(P)},"scheduleDrain"):E=i(function(){setTimeout(F,0)},"scheduleDrain");var _,O=[];function F(){_=!0;for(var P,ee,U=O.length;U;){for(ee=O,O=[],P=-1;++P<U;)ee[P]();U=O.length}_=!1}i(F,"nextTick"),y.exports=H;function H(P){O.push(P)===1&&!_&&E()}i(H,"immediate")}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(h,y,R){"use strict";var C=h(1);function V(){}i(V,"INTERNAL");var E={},Y=["REJECTED"],M=["FULFILLED"],Q=["PENDING"];y.exports=g;function g(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=Q,this.queue=[],this.outcome=void 0,p!==V&&H(this,p)}i(g,"Promise"),g.prototype.catch=function(p){return this.then(null,p)},g.prototype.then=function(p,A){if(typeof p!="function"&&this.state===M||typeof A!="function"&&this.state===Y)return this;var I=new this.constructor(V);if(this.state!==Q){var N=this.state===M?p:A;O(I,N,this.outcome)}else this.queue.push(new _(I,p,A));return I};function _(p,A,I){this.promise=p,typeof A=="function"&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled),typeof I=="function"&&(this.onRejected=I,this.callRejected=this.otherCallRejected)}i(_,"QueueItem"),_.prototype.callFulfilled=function(p){E.resolve(this.promise,p)},_.prototype.otherCallFulfilled=function(p){O(this.promise,this.onFulfilled,p)},_.prototype.callRejected=function(p){E.reject(this.promise,p)},_.prototype.otherCallRejected=function(p){O(this.promise,this.onRejected,p)};function O(p,A,I){C(function(){var N;try{N=A(I)}catch(k){return E.reject(p,k)}N===p?E.reject(p,new TypeError("Cannot resolve promise with itself")):E.resolve(p,N)})}i(O,"unwrap"),E.resolve=function(p,A){var I=P(F,A);if(I.status==="error")return E.reject(p,I.value);var N=I.value;if(N)H(p,N);else{p.state=M,p.outcome=A;for(var k=-1,W=p.queue.length;++k<W;)p.queue[k].callFulfilled(A)}return p},E.reject=function(p,A){p.state=Y,p.outcome=A;for(var I=-1,N=p.queue.length;++I<N;)p.queue[I].callRejected(A);return p};function F(p){var A=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof A=="function")return i(function(){A.apply(p,arguments)},"appyThen")}i(F,"getThen");function H(p,A){var I=!1;function N(j){I||(I=!0,E.reject(p,j))}i(N,"onError");function k(j){I||(I=!0,E.resolve(p,j))}i(k,"onSuccess");function W(){A(k,N)}i(W,"tryToUnwrap");var J=P(W);J.status==="error"&&N(J.value)}i(H,"safelyResolveThenable");function P(p,A){var I={};try{I.value=p(A),I.status="success"}catch(N){I.status="error",I.value=N}return I}i(P,"tryCatch"),g.resolve=ee;function ee(p){return p instanceof this?p:E.resolve(new this(V),p)}i(ee,"resolve"),g.reject=U;function U(p){var A=new this(V);return E.reject(A,p)}i(U,"reject"),g.all=Be;function Be(p){var A=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=p.length,N=!1;if(!I)return this.resolve([]);for(var k=new Array(I),W=0,J=-1,j=new this(V);++J<I;)te(p[J],J);return j;function te(Se,Ce){A.resolve(Se).then(Fe,function(me){N||(N=!0,E.reject(j,me))});function Fe(me){k[Ce]=me,++W===I&&!N&&(N=!0,E.resolve(j,k))}i(Fe,"resolveFromAll")}}i(Be,"all"),g.race=de;function de(p){var A=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=p.length,N=!1;if(!I)return this.resolve([]);for(var k=-1,W=new this(V);++k<I;)J(p[k]);return W;function J(j){A.resolve(j).then(function(te){N||(N=!0,E.resolve(W,te))},function(te){N||(N=!0,E.reject(W,te))})}}i(de,"race")},{"1":1}],3:[function(h,y,R){(function(C){"use strict";typeof C.Promise!="function"&&(C.Promise=h(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"2":2}],4:[function(h,y,R){"use strict";var C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function V(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}i(V,"_classCallCheck");function E(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}i(E,"getIDB");var Y=E();function M(){try{if(!Y||!Y.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),r=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||r)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}i(M,"isIndexedDBValid");function Q(e,r){e=e||[],r=r||{};try{return new Blob(e,r)}catch(n){if(n.name!=="TypeError")throw n;for(var t=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,a=new t,o=0;o<e.length;o+=1)a.append(e[o]);return a.getBlob(r.type)}}i(Q,"createBlob"),typeof Promise>"u"&&h(3);var g=Promise;function _(e,r){r&&e.then(function(t){r(null,t)},function(t){r(t)})}i(_,"executeCallback");function O(e,r,t){typeof r=="function"&&e.then(r),typeof t=="function"&&e.catch(t)}i(O,"executeTwoCallbacks");function F(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}i(F,"normalizeKey");function H(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}i(H,"getCallback");var P="local-forage-detect-blob-support",ee=void 0,U={},Be=Object.prototype.toString,de="readonly",p="readwrite";function A(e){for(var r=e.length,t=new ArrayBuffer(r),a=new Uint8Array(t),o=0;o<r;o++)a[o]=e.charCodeAt(o);return t}i(A,"_binStringToArrayBuffer");function I(e){return new g(function(r){var t=e.transaction(P,p),a=Q([""]);t.objectStore(P).put(a,"key"),t.onabort=function(o){o.preventDefault(),o.stopPropagation(),r(!1)},t.oncomplete=function(){var o=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);r(n||!o||parseInt(o[1],10)>=43)}}).catch(function(){return!1})}i(I,"_checkBlobSupportWithoutCaching");function N(e){return typeof ee=="boolean"?g.resolve(ee):I(e).then(function(r){return ee=r,ee})}i(N,"_checkBlobSupport");function k(e){var r=U[e.name],t={};t.promise=new g(function(a,o){t.resolve=a,t.reject=o}),r.deferredOperations.push(t),r.dbReady?r.dbReady=r.dbReady.then(function(){return t.promise}):r.dbReady=t.promise}i(k,"_deferReadiness");function W(e){var r=U[e.name],t=r.deferredOperations.pop();if(t)return t.resolve(),t.promise}i(W,"_advanceReadiness");function J(e,r){var t=U[e.name],a=t.deferredOperations.pop();if(a)return a.reject(r),a.promise}i(J,"_rejectReadiness");function j(e,r){return new g(function(t,a){if(U[e.name]=U[e.name]||Ge(),e.db)if(r)k(e),e.db.close();else return t(e.db);var o=[e.name];r&&o.push(e.version);var n=Y.open.apply(Y,o);r&&(n.onupgradeneeded=function(u){var c=n.result;try{c.createObjectStore(e.storeName),u.oldVersion<=1&&c.createObjectStore(P)}catch(l){if(l.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+u.oldVersion+" to version "+u.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw l}}),n.onerror=function(u){u.preventDefault(),a(n.error)},n.onsuccess=function(){var u=n.result;u.onversionchange=function(c){c.target.close()},t(u),W(e)}})}i(j,"_getConnection");function te(e){return j(e,!1)}i(te,"_getOriginalConnection");function Se(e){return j(e,!0)}i(Se,"_getUpgradedConnection");function Ce(e,r){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),a=e.version<e.db.version,o=e.version>e.db.version;if(a&&(e.version!==r&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||t){if(t){var n=e.db.version+1;n>e.version&&(e.version=n)}return!0}return!1}i(Ce,"_isUpgradeNeeded");function Fe(e){return new g(function(r,t){var a=new FileReader;a.onerror=t,a.onloadend=function(o){var n=btoa(o.target.result||"");r({__local_forage_encoded_blob:!0,data:n,type:e.type})},a.readAsBinaryString(e)})}i(Fe,"_encodeBlob");function me(e){var r=A(atob(e.data));return Q([r],{type:e.type})}i(me,"_decodeBlob");function qe(e){return e&&e.__local_forage_encoded_blob}i(qe,"_isEncodedBlob");function _t(e){var r=this,t=r._initReady().then(function(){var a=U[r._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return O(t,e,e),t}i(_t,"_fullyReady");function wt(e){k(e);for(var r=U[e.name],t=r.forages,a=0;a<t.length;a++){var o=t[a];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,te(e).then(function(n){return e.db=n,Ce(e)?Se(e):n}).then(function(n){e.db=r.db=n;for(var u=0;u<t.length;u++)t[u]._dbInfo.db=n}).catch(function(n){throw J(e,n),n})}i(wt,"_tryReconnect");function re(e,r,t,a){a===void 0&&(a=1);try{var o=e.db.transaction(e.storeName,r);t(null,o)}catch(n){if(a>0&&(!e.db||n.name==="InvalidStateError"||n.name==="NotFoundError"))return g.resolve().then(function(){if(!e.db||n.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),Se(e)}).then(function(){return wt(e).then(function(){re(e,r,t,a-1)})}).catch(t);t(n)}}i(re,"createTransaction");function Ge(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}i(Ge,"createDbContext");function It(e){var r=this,t={db:null};if(e)for(var a in e)t[a]=e[a];var o=U[t.name];o||(o=Ge(),U[t.name]=o),o.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=_t);var n=[];function u(){return g.resolve()}i(u,"ignoreErrors");for(var c=0;c<o.forages.length;c++){var l=o.forages[c];l!==r&&n.push(l._initReady().catch(u))}var d=o.forages.slice(0);return g.all(n).then(function(){return t.db=o.db,te(t)}).then(function(v){return t.db=v,Ce(t,r._defaultConfig.version)?Se(t):v}).then(function(v){t.db=o.db=v,r._dbInfo=t;for(var b=0;b<d.length;b++){var w=d[b];w!==r&&(w._dbInfo.db=t.db,w._dbInfo.version=t.version)}})}i(It,"_initStorage");function Et(e,r){var t=this;e=F(e);var a=new g(function(o,n){t.ready().then(function(){re(t._dbInfo,de,function(u,c){if(u)return n(u);try{var l=c.objectStore(t._dbInfo.storeName),d=l.get(e);d.onsuccess=function(){var v=d.result;v===void 0&&(v=null),qe(v)&&(v=me(v)),o(v)},d.onerror=function(){n(d.error)}}catch(v){n(v)}})}).catch(n)});return _(a,r),a}i(Et,"getItem");function At(e,r){var t=this,a=new g(function(o,n){t.ready().then(function(){re(t._dbInfo,de,function(u,c){if(u)return n(u);try{var l=c.objectStore(t._dbInfo.storeName),d=l.openCursor(),v=1;d.onsuccess=function(){var b=d.result;if(b){var w=b.value;qe(w)&&(w=me(w));var T=e(w,b.key,v++);T!==void 0?o(T):b.continue()}else o()},d.onerror=function(){n(d.error)}}catch(b){n(b)}})}).catch(n)});return _(a,r),a}i(At,"iterate");function Tt(e,r,t){var a=this;e=F(e);var o=new g(function(n,u){var c;a.ready().then(function(){return c=a._dbInfo,Be.call(r)==="[object Blob]"?N(c.db).then(function(l){return l?r:Fe(r)}):r}).then(function(l){re(a._dbInfo,p,function(d,v){if(d)return u(d);try{var b=v.objectStore(a._dbInfo.storeName);l===null&&(l=void 0);var w=b.put(l,e);v.oncomplete=function(){l===void 0&&(l=null),n(l)},v.onabort=v.onerror=function(){var T=w.error?w.error:w.transaction.error;u(T)}}catch(T){u(T)}})}).catch(u)});return _(o,t),o}i(Tt,"setItem");function Dt(e,r){var t=this;e=F(e);var a=new g(function(o,n){t.ready().then(function(){re(t._dbInfo,p,function(u,c){if(u)return n(u);try{var l=c.objectStore(t._dbInfo.storeName),d=l.delete(e);c.oncomplete=function(){o()},c.onerror=function(){n(d.error)},c.onabort=function(){var v=d.error?d.error:d.transaction.error;n(v)}}catch(v){n(v)}})}).catch(n)});return _(a,r),a}i(Dt,"removeItem");function Nt(e){var r=this,t=new g(function(a,o){r.ready().then(function(){re(r._dbInfo,p,function(n,u){if(n)return o(n);try{var c=u.objectStore(r._dbInfo.storeName),l=c.clear();u.oncomplete=function(){a()},u.onabort=u.onerror=function(){var d=l.error?l.error:l.transaction.error;o(d)}}catch(d){o(d)}})}).catch(o)});return _(t,e),t}i(Nt,"clear");function Ct(e){var r=this,t=new g(function(a,o){r.ready().then(function(){re(r._dbInfo,de,function(n,u){if(n)return o(n);try{var c=u.objectStore(r._dbInfo.storeName),l=c.count();l.onsuccess=function(){a(l.result)},l.onerror=function(){o(l.error)}}catch(d){o(d)}})}).catch(o)});return _(t,e),t}i(Ct,"length");function Rt(e,r){var t=this,a=new g(function(o,n){if(e<0){o(null);return}t.ready().then(function(){re(t._dbInfo,de,function(u,c){if(u)return n(u);try{var l=c.objectStore(t._dbInfo.storeName),d=!1,v=l.openKeyCursor();v.onsuccess=function(){var b=v.result;if(!b){o(null);return}e===0||d?o(b.key):(d=!0,b.advance(e))},v.onerror=function(){n(v.error)}}catch(b){n(b)}})}).catch(n)});return _(a,r),a}i(Rt,"key");function xt(e){var r=this,t=new g(function(a,o){r.ready().then(function(){re(r._dbInfo,de,function(n,u){if(n)return o(n);try{var c=u.objectStore(r._dbInfo.storeName),l=c.openKeyCursor(),d=[];l.onsuccess=function(){var v=l.result;if(!v){a(d);return}d.push(v.key),v.continue()},l.onerror=function(){o(l.error)}}catch(v){o(v)}})}).catch(o)});return _(t,e),t}i(xt,"keys");function Ot(e,r){r=H.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var a=this,o;if(!e.name)o=g.reject("Invalid arguments");else{var n=e.name===t.name&&a._dbInfo.db,u=n?g.resolve(a._dbInfo.db):te(e).then(function(c){var l=U[e.name],d=l.forages;l.db=c;for(var v=0;v<d.length;v++)d[v]._dbInfo.db=c;return c});e.storeName?o=u.then(function(c){if(!!c.objectStoreNames.contains(e.storeName)){var l=c.version+1;k(e);var d=U[e.name],v=d.forages;c.close();for(var b=0;b<v.length;b++){var w=v[b];w._dbInfo.db=null,w._dbInfo.version=l}var T=new g(function(D,B){var x=Y.open(e.name,l);x.onerror=function(q){var we=x.result;we.close(),B(q)},x.onupgradeneeded=function(){var q=x.result;q.deleteObjectStore(e.storeName)},x.onsuccess=function(){var q=x.result;q.close(),D(q)}});return T.then(function(D){d.db=D;for(var B=0;B<v.length;B++){var x=v[B];x._dbInfo.db=D,W(x._dbInfo)}}).catch(function(D){throw(J(e,D)||g.resolve()).catch(function(){}),D})}}):o=u.then(function(c){k(e);var l=U[e.name],d=l.forages;c.close();for(var v=0;v<d.length;v++){var b=d[v];b._dbInfo.db=null}var w=new g(function(T,D){var B=Y.deleteDatabase(e.name);B.onerror=function(){var x=B.result;x&&x.close(),D(B.error)},B.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},B.onsuccess=function(){var x=B.result;x&&x.close(),T(x)}});return w.then(function(T){l.db=T;for(var D=0;D<d.length;D++){var B=d[D];W(B._dbInfo)}}).catch(function(T){throw(J(e,T)||g.resolve()).catch(function(){}),T})})}return _(o,r),o}i(Ot,"dropInstance");var Bt={_driver:"asyncStorage",_initStorage:It,_support:M(),iterate:At,getItem:Et,setItem:Tt,removeItem:Dt,clear:Nt,length:Ct,key:Rt,keys:xt,dropInstance:Ot};function Ft(){return typeof openDatabase=="function"}i(Ft,"isWebSQLValid");var ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pt="~~local_forage_type~",Qe=/^~~local_forage_type~([^~]+)~/,Re="__lfsc__:",Pe=Re.length,Le="arbf",Ue="blob",He="si08",Xe="ui08",Ze="uic8",et="si16",tt="si32",rt="ur16",nt="ui32",at="fl32",ot="fl64",it=Pe+Le.length,st=Object.prototype.toString;function ut(e){var r=e.length*.75,t=e.length,a,o=0,n,u,c,l;e[e.length-1]==="="&&(r--,e[e.length-2]==="="&&r--);var d=new ArrayBuffer(r),v=new Uint8Array(d);for(a=0;a<t;a+=4)n=ie.indexOf(e[a]),u=ie.indexOf(e[a+1]),c=ie.indexOf(e[a+2]),l=ie.indexOf(e[a+3]),v[o++]=n<<2|u>>4,v[o++]=(u&15)<<4|c>>2,v[o++]=(c&3)<<6|l&63;return d}i(ut,"stringToBuffer");function $e(e){var r=new Uint8Array(e),t="",a;for(a=0;a<r.length;a+=3)t+=ie[r[a]>>2],t+=ie[(r[a]&3)<<4|r[a+1]>>4],t+=ie[(r[a+1]&15)<<2|r[a+2]>>6],t+=ie[r[a+2]&63];return r.length%3===2?t=t.substring(0,t.length-1)+"=":r.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}i($e,"bufferToString");function Lt(e,r){var t="";if(e&&(t=st.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&st.call(e.buffer)==="[object ArrayBuffer]")){var a,o=Re;e instanceof ArrayBuffer?(a=e,o+=Le):(a=e.buffer,t==="[object Int8Array]"?o+=He:t==="[object Uint8Array]"?o+=Xe:t==="[object Uint8ClampedArray]"?o+=Ze:t==="[object Int16Array]"?o+=et:t==="[object Uint16Array]"?o+=rt:t==="[object Int32Array]"?o+=tt:t==="[object Uint32Array]"?o+=nt:t==="[object Float32Array]"?o+=at:t==="[object Float64Array]"?o+=ot:r(new Error("Failed to get type for BinaryArray"))),r(o+$e(a))}else if(t==="[object Blob]"){var n=new FileReader;n.onload=function(){var u=Pt+e.type+"~"+$e(this.result);r(Re+Ue+u)},n.readAsArrayBuffer(e)}else try{r(JSON.stringify(e))}catch(u){console.error("Couldn't convert value into a JSON string: ",e),r(null,u)}}i(Lt,"serialize");function Ut(e){if(e.substring(0,Pe)!==Re)return JSON.parse(e);var r=e.substring(it),t=e.substring(Pe,it),a;if(t===Ue&&Qe.test(r)){var o=r.match(Qe);a=o[1],r=r.substring(o[0].length)}var n=ut(r);switch(t){case Le:return n;case Ue:return Q([n],{type:a});case He:return new Int8Array(n);case Xe:return new Uint8Array(n);case Ze:return new Uint8ClampedArray(n);case et:return new Int16Array(n);case rt:return new Uint16Array(n);case tt:return new Int32Array(n);case nt:return new Uint32Array(n);case at:return new Float32Array(n);case ot:return new Float64Array(n);default:throw new Error("Unkown type: "+t)}}i(Ut,"deserialize");var Ve={serialize:Lt,deserialize:Ut,stringToBuffer:ut,bufferToString:$e};function ft(e,r,t,a){e.executeSql("CREATE TABLE IF NOT EXISTS "+r.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,a)}i(ft,"createDbTable");function $t(e){var r=this,t={db:null};if(e)for(var a in e)t[a]=typeof e[a]!="string"?e[a].toString():e[a];var o=new g(function(n,u){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(c){return u(c)}t.db.transaction(function(c){ft(c,t,function(){r._dbInfo=t,n()},function(l,d){u(d)})},u)});return t.serializer=Ve,o}i($t,"_initStorage$1");function se(e,r,t,a,o,n){e.executeSql(t,a,o,function(u,c){c.code===c.SYNTAX_ERR?u.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[r.storeName],function(l,d){d.rows.length?n(l,c):ft(l,r,function(){l.executeSql(t,a,o,n)},n)},n):n(u,c)},n)}i(se,"tryExecuteSql");function Vt(e,r){var t=this;e=F(e);var a=new g(function(o,n){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(c){se(c,u,"SELECT * FROM "+u.storeName+" WHERE key = ? LIMIT 1",[e],function(l,d){var v=d.rows.length?d.rows.item(0).value:null;v&&(v=u.serializer.deserialize(v)),o(v)},function(l,d){n(d)})})}).catch(n)});return _(a,r),a}i(Vt,"getItem$1");function Mt(e,r){var t=this,a=new g(function(o,n){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(c){se(c,u,"SELECT * FROM "+u.storeName,[],function(l,d){for(var v=d.rows,b=v.length,w=0;w<b;w++){var T=v.item(w),D=T.value;if(D&&(D=u.serializer.deserialize(D)),D=e(D,T.key,w+1),D!==void 0){o(D);return}}o()},function(l,d){n(d)})})}).catch(n)});return _(a,r),a}i(Mt,"iterate$1");function ct(e,r,t,a){var o=this;e=F(e);var n=new g(function(u,c){o.ready().then(function(){r===void 0&&(r=null);var l=r,d=o._dbInfo;d.serializer.serialize(r,function(v,b){b?c(b):d.db.transaction(function(w){se(w,d,"INSERT OR REPLACE INTO "+d.storeName+" (key, value) VALUES (?, ?)",[e,v],function(){u(l)},function(T,D){c(D)})},function(w){if(w.code===w.QUOTA_ERR){if(a>0){u(ct.apply(o,[e,l,t,a-1]));return}c(w)}})})}).catch(c)});return _(n,t),n}i(ct,"_setItem");function kt(e,r,t){return ct.apply(this,[e,r,t,1])}i(kt,"setItem$1");function Yt(e,r){var t=this;e=F(e);var a=new g(function(o,n){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(c){se(c,u,"DELETE FROM "+u.storeName+" WHERE key = ?",[e],function(){o()},function(l,d){n(d)})})}).catch(n)});return _(a,r),a}i(Yt,"removeItem$1");function zt(e){var r=this,t=new g(function(a,o){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(u){se(u,n,"DELETE FROM "+n.storeName,[],function(){a()},function(c,l){o(l)})})}).catch(o)});return _(t,e),t}i(zt,"clear$1");function Kt(e){var r=this,t=new g(function(a,o){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(u){se(u,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(c,l){var d=l.rows.item(0).c;a(d)},function(c,l){o(l)})})}).catch(o)});return _(t,e),t}i(Kt,"length$1");function Wt(e,r){var t=this,a=new g(function(o,n){t.ready().then(function(){var u=t._dbInfo;u.db.transaction(function(c){se(c,u,"SELECT key FROM "+u.storeName+" WHERE id = ? LIMIT 1",[e+1],function(l,d){var v=d.rows.length?d.rows.item(0).key:null;o(v)},function(l,d){n(d)})})}).catch(n)});return _(a,r),a}i(Wt,"key$1");function Jt(e){var r=this,t=new g(function(a,o){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(u){se(u,n,"SELECT key FROM "+n.storeName,[],function(c,l){for(var d=[],v=0;v<l.rows.length;v++)d.push(l.rows.item(v).key);a(d)},function(c,l){o(l)})})}).catch(o)});return _(t,e),t}i(Jt,"keys$1");function jt(e){return new g(function(r,t){e.transaction(function(a){a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(o,n){for(var u=[],c=0;c<n.rows.length;c++)u.push(n.rows.item(c).name);r({db:e,storeNames:u})},function(o,n){t(n)})},function(a){t(a)})})}i(jt,"getAllStoreNames");function qt(e,r){r=H.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var a=this,o;return e.name?o=new g(function(n){var u;e.name===t.name?u=a._dbInfo.db:u=openDatabase(e.name,"","",0),e.storeName?n({db:u,storeNames:[e.storeName]}):n(jt(u))}).then(function(n){return new g(function(u,c){n.db.transaction(function(l){function d(T){return new g(function(D,B){l.executeSql("DROP TABLE IF EXISTS "+T,[],function(){D()},function(x,q){B(q)})})}i(d,"dropTable");for(var v=[],b=0,w=n.storeNames.length;b<w;b++)v.push(d(n.storeNames[b]));g.all(v).then(function(){u()}).catch(function(T){c(T)})},function(l){c(l)})})}):o=g.reject("Invalid arguments"),_(o,r),o}i(qt,"dropInstance$1");var Gt={_driver:"webSQLStorage",_initStorage:$t,_support:Ft(),iterate:Mt,getItem:Vt,setItem:kt,removeItem:Yt,clear:zt,length:Kt,key:Wt,keys:Jt,dropInstance:qt};function Qt(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}i(Qt,"isLocalStorageValid");function lt(e,r){var t=e.name+"/";return e.storeName!==r.storeName&&(t+=e.storeName+"/"),t}i(lt,"_getKeyPrefix");function Ht(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}i(Ht,"checkIfLocalStorageThrows");function Xt(){return!Ht()||localStorage.length>0}i(Xt,"_isLocalStorageUsable");function Zt(e){var r=this,t={};if(e)for(var a in e)t[a]=e[a];return t.keyPrefix=lt(e,r._defaultConfig),Xt()?(r._dbInfo=t,t.serializer=Ve,g.resolve()):g.reject()}i(Zt,"_initStorage$2");function er(e){var r=this,t=r.ready().then(function(){for(var a=r._dbInfo.keyPrefix,o=localStorage.length-1;o>=0;o--){var n=localStorage.key(o);n.indexOf(a)===0&&localStorage.removeItem(n)}});return _(t,e),t}i(er,"clear$2");function tr(e,r){var t=this;e=F(e);var a=t.ready().then(function(){var o=t._dbInfo,n=localStorage.getItem(o.keyPrefix+e);return n&&(n=o.serializer.deserialize(n)),n});return _(a,r),a}i(tr,"getItem$2");function rr(e,r){var t=this,a=t.ready().then(function(){for(var o=t._dbInfo,n=o.keyPrefix,u=n.length,c=localStorage.length,l=1,d=0;d<c;d++){var v=localStorage.key(d);if(v.indexOf(n)===0){var b=localStorage.getItem(v);if(b&&(b=o.serializer.deserialize(b)),b=e(b,v.substring(u),l++),b!==void 0)return b}}});return _(a,r),a}i(rr,"iterate$2");function nr(e,r){var t=this,a=t.ready().then(function(){var o=t._dbInfo,n;try{n=localStorage.key(e)}catch{n=null}return n&&(n=n.substring(o.keyPrefix.length)),n});return _(a,r),a}i(nr,"key$2");function ar(e){var r=this,t=r.ready().then(function(){for(var a=r._dbInfo,o=localStorage.length,n=[],u=0;u<o;u++){var c=localStorage.key(u);c.indexOf(a.keyPrefix)===0&&n.push(c.substring(a.keyPrefix.length))}return n});return _(t,e),t}i(ar,"keys$2");function or(e){var r=this,t=r.keys().then(function(a){return a.length});return _(t,e),t}i(or,"length$2");function ir(e,r){var t=this;e=F(e);var a=t.ready().then(function(){var o=t._dbInfo;localStorage.removeItem(o.keyPrefix+e)});return _(a,r),a}i(ir,"removeItem$2");function sr(e,r,t){var a=this;e=F(e);var o=a.ready().then(function(){r===void 0&&(r=null);var n=r;return new g(function(u,c){var l=a._dbInfo;l.serializer.serialize(r,function(d,v){if(v)c(v);else try{localStorage.setItem(l.keyPrefix+e,d),u(n)}catch(b){(b.name==="QuotaExceededError"||b.name==="NS_ERROR_DOM_QUOTA_REACHED")&&c(b),c(b)}})})});return _(o,t),o}i(sr,"setItem$2");function ur(e,r){if(r=H.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var a=this,o;return e.name?o=new g(function(n){e.storeName?n(lt(e,a._defaultConfig)):n(e.name+"/")}).then(function(n){for(var u=localStorage.length-1;u>=0;u--){var c=localStorage.key(u);c.indexOf(n)===0&&localStorage.removeItem(c)}}):o=g.reject("Invalid arguments"),_(o,r),o}i(ur,"dropInstance$2");var fr={_driver:"localStorageWrapper",_initStorage:Zt,_support:Qt(),iterate:rr,getItem:tr,setItem:sr,removeItem:ir,clear:er,length:or,key:nr,keys:ar,dropInstance:ur},cr=i(function(r,t){return r===t||typeof r=="number"&&typeof t=="number"&&isNaN(r)&&isNaN(t)},"sameValue"),lr=i(function(r,t){for(var a=r.length,o=0;o<a;){if(cr(r[o],t))return!0;o++}return!1},"includes"),dt=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},_e={},ht={},pe={INDEXEDDB:Bt,WEBSQL:Gt,LOCALSTORAGE:fr},dr=[pe.INDEXEDDB._driver,pe.WEBSQL._driver,pe.LOCALSTORAGE._driver],xe=["dropInstance"],Me=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(xe),hr={description:"",driver:dr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function vr(e,r){e[r]=function(){var t=arguments;return e.ready().then(function(){return e[r].apply(e,t)})}}i(vr,"callWhenReady");function ke(){for(var e=1;e<arguments.length;e++){var r=arguments[e];if(r)for(var t in r)r.hasOwnProperty(t)&&(dt(r[t])?arguments[0][t]=r[t].slice():arguments[0][t]=r[t])}return arguments[0]}i(ke,"extend");var yr=function(){function e(r){V(this,e);for(var t in pe)if(pe.hasOwnProperty(t)){var a=pe[t],o=a._driver;this[t]=o,_e[o]||this.defineDriver(a)}this._defaultConfig=ke({},hr),this._config=ke({},this._defaultConfig,r),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return i(e,"LocalForage"),e.prototype.config=i(function(t){if((typeof t>"u"?"undefined":C(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var a in t){if(a==="storeName"&&(t[a]=t[a].replace(/\W/g,"_")),a==="version"&&typeof t[a]!="number")return new Error("Database version must be a number.");this._config[a]=t[a]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},"config"),e.prototype.defineDriver=i(function(t,a,o){var n=new g(function(u,c){try{var l=t._driver,d=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){c(d);return}for(var v=Me.concat("_initStorage"),b=0,w=v.length;b<w;b++){var T=v[b],D=!lr(xe,T);if((D||t[T])&&typeof t[T]!="function"){c(d);return}}var B=i(function(){for(var we=i(function(gr){return function(){var br=new Error("Method "+gr+" is not implemented by the current driver"),vt=g.reject(br);return _(vt,arguments[arguments.length-1]),vt}},"methodNotImplementedFactory"),Ye=0,pr=xe.length;Ye<pr;Ye++){var ze=xe[Ye];t[ze]||(t[ze]=we(ze))}},"configureMissingMethods");B();var x=i(function(we){_e[l]&&console.info("Redefining LocalForage driver: "+l),_e[l]=t,ht[l]=we,u()},"setDriverSupport");"_support"in t?t._support&&typeof t._support=="function"?t._support().then(x,c):x(!!t._support):x(!0)}catch(q){c(q)}});return O(n,a,o),n},"defineDriver"),e.prototype.driver=i(function(){return this._driver||null},"driver"),e.prototype.getDriver=i(function(t,a,o){var n=_e[t]?g.resolve(_e[t]):g.reject(new Error("Driver not found."));return O(n,a,o),n},"getDriver"),e.prototype.getSerializer=i(function(t){var a=g.resolve(Ve);return O(a,t),a},"getSerializer"),e.prototype.ready=i(function(t){var a=this,o=a._driverSet.then(function(){return a._ready===null&&(a._ready=a._initDriver()),a._ready});return O(o,t,t),o},"ready"),e.prototype.setDriver=i(function(t,a,o){var n=this;dt(t)||(t=[t]);var u=this._getSupportedDrivers(t);function c(){n._config.driver=n.driver()}i(c,"setDriverToConfig");function l(b){return n._extend(b),c(),n._ready=n._initStorage(n._config),n._ready}i(l,"extendSelfWithDriver");function d(b){return function(){var w=0;function T(){for(;w<b.length;){var D=b[w];return w++,n._dbInfo=null,n._ready=null,n.getDriver(D).then(l).catch(T)}c();var B=new Error("No available storage method found.");return n._driverSet=g.reject(B),n._driverSet}return i(T,"driverPromiseLoop"),T()}}i(d,"initDriver");var v=this._driverSet!==null?this._driverSet.catch(function(){return g.resolve()}):g.resolve();return this._driverSet=v.then(function(){var b=u[0];return n._dbInfo=null,n._ready=null,n.getDriver(b).then(function(w){n._driver=w._driver,c(),n._wrapLibraryMethodsWithReady(),n._initDriver=d(u)})}).catch(function(){c();var b=new Error("No available storage method found.");return n._driverSet=g.reject(b),n._driverSet}),O(this._driverSet,a,o),this._driverSet},"setDriver"),e.prototype.supports=i(function(t){return!!ht[t]},"supports"),e.prototype._extend=i(function(t){ke(this,t)},"_extend"),e.prototype._getSupportedDrivers=i(function(t){for(var a=[],o=0,n=t.length;o<n;o++){var u=t[o];this.supports(u)&&a.push(u)}return a},"_getSupportedDrivers"),e.prototype._wrapLibraryMethodsWithReady=i(function(){for(var t=0,a=Me.length;t<a;t++)vr(this,Me[t])},"_wrapLibraryMethodsWithReady"),e.prototype.createInstance=i(function(t){return new e(t)},"createInstance"),e}(),mr=new yr;y.exports=mr},{"3":3}]},{},[4])(4)})});var yt=i(m=>m==null,"isNil");var mt=(m=>(s=12)=>Number(`${m++}`.padStart(s,"0")))(Date.now());var fe=class{constructor(){this.value=mt()}};i(fe,"SchemaId");var Nr=i(m=>{switch(m){case Number:return 0;case Boolean:return!1;case String:return"";case Array:case Float32Array:case Float64Array:case Int8Array:case Int16Array:case Int32Array:case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:return new m;case ArrayBuffer:return new m(0);default:return null}},"getDefaultValue"),Je=i((m,s)=>{try{return s instanceof m||typeof s===m.name.toLowerCase()}catch{return!1}},"isSameValueType"),Z=class{constructor(s,f=!1,h=null){this.type=s;this.required=f;this.defaultValue=h;if(h!==null&&!Je(s,h))throw new Error(`Default value "${h}" does not match type "${s.name}"`);this.defaultValue=h??Nr(this.type)}toJSON(){return{type:this.type instanceof ne?this.type.toJSON():this.type.name,required:this.required,defaultValue:this.defaultValue}}toString(){return JSON.stringify(this.toJSON(),null,4)}};i(Z,"SchemaValue");var Ee,L,Ae,Te,ue=class{constructor(s,f=null,h=!0){z(this,Ee,["id","createdDate","lastUpdatedDate"]);z(this,L,{id:new Z(fe,!1),createdDate:new Z(Date,!1),lastUpdatedDate:new Z(Date,!1)});z(this,Ae,void 0);z(this,Te,!0);if(K(this,Ae,s),K(this,Te,h),h||K(this,L,{}),f){for(let y in f)if(f.hasOwnProperty(y))if(f[y]instanceof Z)S(this,Ee).includes(y)||(S(this,L)[y]=f[y]);else throw new Error(`Field "${y}" is not a SchemaValue`)}}get name(){return S(this,Ae)}get includeDefaultKeys(){return S(this,Te)}get defaultKeys(){return S(this,Ee)}defineField(s,f,{defaultValue:h,required:y}={defaultValue:null,required:!1}){S(this,L)[`${s}`]=new Z(f,y,h)}removeField(s){if(s){let[f,...h]=`${s}`.split("."),y=S(this,L)[f];y&&(h.length?y.type instanceof ue&&y.type.removeField(h.join(".")):delete S(this,L)[f])}}hasField(s){if(s){let[f,...h]=`${s}`.split("."),y=S(this,L)[f];if(y)if(h.length){if(y.type instanceof ue)return y.type.hasField(h.join("."))}else return S(this,L).hasOwnProperty(f)}return!1}getField(s){if(s){let[f,...h]=`${s}`.split("."),y=S(this,L)[f];return y&&h.length&&y.type instanceof ue?y.type.getField(h.join(".")):y??null}return null}isValidFieldValue(s,f=null){let h=this.getField(`${s}`);return h?f instanceof Array&&f.some(y=>!Cr(y))?!1:h.type instanceof ue?`${f}`=="[object Object]"&&h.type.getInvalidSchemaDataFields(f).length===0:h.required?!yt(f)&&Je(h.type,f):f===null||f===h.defaultValue||Je(h.type,f):!1}getInvalidSchemaDataFields(s){let f=new Set,h=Object.keys(S(this,L)).filter(y=>S(this,L)[y].required);for(let y of[...Object.keys(s),...h])if(!this.defaultKeys.includes(y)){let R=this.getField(y);if(R?.type instanceof ue){let C=s[y];`${C}`=="[object Object]"?R.type.getInvalidSchemaDataFields(C).map(V=>{f.add(`${y}.${V}`)}):f.add(y);continue}this.isValidFieldValue(y,s[y])||f.add(y)}return Array.from(f)}toJSON(){let s={};for(let f in S(this,L))if(S(this,L).hasOwnProperty(f)){let h=S(this,L)[f];s[f]=h.toJSON()}return s}toString(){return JSON.stringify(this.toJSON(),null,4)}toValue(){let s=new Date,f=this.includeDefaultKeys?{id:new fe().value,createdDate:s,lastUpdatedDate:s}:{};for(let h in S(this,L))if(S(this,L).hasOwnProperty(h)&&!this.defaultKeys.includes(h)){let y=S(this,L)[h];switch(!0){case y.type instanceof ue:f[h]=y.type.toValue();break;case y.type instanceof Date:f[h]=y.defaultValue??new Date;break;default:f[h]=y.defaultValue}}return f}},ne=ue;i(ne,"Schema"),Ee=new WeakMap,L=new WeakMap,Ae=new WeakMap,Te=new WeakMap;function Cr(m){return m===null||[ne,fe,Date,Number,String,Boolean,Array,ArrayBuffer,Blob,Float32Array,Float64Array,Int8Array,Int16Array,Int32Array,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array].some(s=>m instanceof s||typeof m===s.name.toLowerCase())}i(Cr,"isSupportedTypeValue");var G=Dr(gt());var ae=i((m,s)=>typeof s=="function"?s(null,m):Promise.resolve(m),"callBackOrPromise"),Oe="Memory",bt=i(()=>{let m=new Map;return{_driver:Oe,_initStorage(){return m},async clear(s){ae(m.clear(),s)},async getItem(s,f){return ae(m.get(s)??null,f)||null},async iterate(s,f){let h=0,y;for(let[R,C]of m.entries()){if(y=s(C,R,h),y!==void 0)return ae(y,f);h+=1}return ae(null,f)},async key(s,f){return ae(Array.from(m.keys())[s],f)||""},async keys(s){return ae(Array.from(m.keys()),s)||[]},async length(s){return ae(m.size,s)||0},async removeItem(s,f){return ae(m.delete(s),f)},async setItem(s,f,h){return ae(m.set(s,f),h)}}},"MemoryStore");G.default.defineDriver(bt());var St={version:1,type:[G.INDEXEDDB,G.WEBSQL,G.LOCALSTORAGE,Oe],description:"",appName:"App"},$,oe,De,X,ve,Ne,ye,ce,be,he=class{constructor(s,f,h=St){z(this,ce);z(this,$,void 0);z(this,oe,void 0);z(this,De,void 0);z(this,X,void 0);z(this,ve,[]);z(this,Ne,!1);z(this,ye,0);if(K(this,De,s),K(this,oe,{...St,...h}),!(f instanceof ne))throw new Error('Missing or unknown "Schema"');let y=S(this,oe).appName||"App";K(this,X,f),K(this,$,G.default.createInstance({driver:S(this,oe).type,version:S(this,oe).version,description:S(this,oe).description,name:y,storeName:s})),S(this,$).ready(()=>{console.info(`[Info] ClientStore "${s}" successfully created`),K(this,Ne,!0),ge(this,ce,be).call(this,he.EventType.READY,null)})}get ready(){return S(this,Ne)}get type(){return S(this,$).driver()}get name(){return`${S(this,oe).appName}-${S(this,De)}`}get size(){return S(this,ye)}subscribe(s){return typeof s=="function"&&S(this,ve).push(s),()=>{K(this,ve,S(this,ve).filter(f=>f!==s))}}async loadItems(s=[]){if(s.length){let f=new Set(await S(this,$).keys());for(let h of s)f.has(`${h.id}`)?await this.updateItem(h.id,h):await this.createItem(h)}}async createItem(s){let f=S(this,X).getInvalidSchemaDataFields(s);if(!f.length){let h=S(this,X).toValue();for(let y in s)s.hasOwnProperty(y)&&!S(this,X).defaultKeys.includes(y)&&(h[y]=s[y]);try{await S(this,$).setItem(`${h.id}`,h),K(this,ye,await S(this,$).length())}catch(y){console.error(`Failed to create item "${s}"`,y)}return ge(this,ce,be).call(this,he.EventType.CREATE,h.id),h}throw new Error(`Failed to create item. Field(s) "${f.join(", ")}" do not match the schema: ${S(this,X)}`)}async updateItem(s,f){for(let R in f)if(f.hasOwnProperty(R)&&!S(this,X).defaultKeys.includes(R)&&!S(this,X).isValidFieldValue(R,f[R]))throw new Error(`Failed to update item "${s}". Key "${R}" is unknown or has invalid value type: ${S(this,X).getField(R)}`);let h=await this.getItem(s),y={...h,...f,createdDate:h.createdDate,lastUpdatedDate:new Date,id:h.id};try{await S(this,$).setItem(`${h.id}`,y)}catch(R){console.error(`Failed to update item "${h}"`,R)}return ge(this,ce,be).call(this,he.EventType.UPDATE,s),y}async getItems(){return this.findItems(()=>!0)}getItem(s){return S(this,$).getItem(`${s}`)}removeItem(s){return S(this,$).removeItem(`${s}`).then(async()=>{K(this,ye,await S(this,$).length()),ge(this,ce,be).call(this,he.EventType.DELETE,s)})}async clear(){let s=(await S(this,$).keys()).map(Number);return S(this,$).clear().then(async()=>{K(this,ye,await S(this,$).length()),ge(this,ce,be).call(this,he.EventType.CLEAR,s)})}async findItem(s=()=>!1){return S(this,$).iterate((f,h)=>{if(s(f,h))return f})||null}async findItems(s=()=>!1){let f=[];return await S(this,$).iterate((h,y)=>{s(h,y)&&h&&f.push(h)}),f}},le=he;i(le,"ClientStore"),$=new WeakMap,oe=new WeakMap,De=new WeakMap,X=new WeakMap,ve=new WeakMap,Ne=new WeakMap,ye=new WeakMap,ce=new WeakSet,be=i(function(s,f=null){S(this,ve).forEach(h=>h(s,f))},"#broadcast");(f=>{let m;(E=>(E.READY="ready",E.CREATE="created",E.DELETE="deleted",E.UPDATE="updated",E.CLEAR="cleared"))(m=f.EventType||(f.EventType={})),f.Type={LOCALSTORAGE:G.LOCALSTORAGE,WEBSQL:G.WEBSQL,INDEXEDDB:G.INDEXEDDB,MEMORY_STORAGE:Oe}})(le||(le={}));window&&(window.Schema=ne,window.SchemaValue=Z,window.SchemaId=fe,window.ClientStore=le);})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
//# sourceMappingURL=client-web-storage.min.js.map
